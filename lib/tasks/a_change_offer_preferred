namespace :v5_8_5 do
  task a_change_offer_preferred: :environment do
    require 'roo'
    file = "#{Rails.root}/tmp/preferred_offers.xlsx" # 将文本路径赋给对象
    if File.exists?(file)
      # 打开文本赋值给xlsx对象，将文本第一列赋值给对象sheet
      xlsx       = Roo::Spreadsheet.open(file, extension: :xlsx)
      sheet      = xlsx.sheet(0)

      # 这里将读取出来的数据更新到数据表中
      sheet.each do |row|
        job = job.find_by(id: row[0])
        job.update_columns(title: row[1], description: row[2], position: row[3])
      end
    end
  end
end
